# linux配置网络详解

[TOC]

https://blog.csdn.net/liaoyaonline/article/details/129347477

## 前置准备

确定是否有网，比如在家里，确定是否连上网线？确定这个网线的网关是什么？（这个需要和给你办网的人确定），在公司的话，网络是连接到交换机上的，所以你需要确定你连的交换机的网段是什么？一般而言机房的交换机都有指定的负责人，直接找他就行。

以公司配置网络为例，一般配置网络都是为了让本机访问到测试机器。所以注意下面名词

本机：指公司内网已经配置好的机器，不需要操作。

测试机器:就是本次教程中配置网络得到机器。

## 配置流程

- 配置`ip`

  - 先确定自己连接网线的网口在界面上是哪个？使用命令`ifconfig`能够看到显示的网口，然后使用`ethtool -p eth0`这个命令的作用是让`eth0`口不断的闪光，让你能找到`eth0`对应的网口是在哪。确定了你接的网口是对应的哪个`eth_x`，一般默认是在`eth1`对应的网口连接网线，网线连接好了可以使用`ethtool eth1`查看`eth1`这个网口网线的连接情况，一般是在最后一行的`link xxxx`是`yes`。

  - 可以配置`ip`了，第一步我们是把网线连接在`eth1`口上，在前置准备中我们知道网线对应的网关是`10.130.48.1/24`那么我们可以选择`10.130.48.1 - 255`之间的任何一个`ip`作为机器的`ip`要先确定这个`ip`没有人在使用，测试手段是让前置准备联系到的交换机负责人，让他用同网段的机器去`ping`这个`ip`，如果没`ping`通，说明没人在用，经过这个环节我们确认了`10.130.48.155`作为我们机器的`ip`，配置`ip`的命令如下所示：

    ```
    ifconfig eth1 10.130.48.155/24 up
    ```

    ![image-20230305161612717](linux%E9%85%8D%E7%BD%AE%E7%BD%91%E7%BB%9C%E8%AF%A6%E8%A7%A3.assets/image-20230305161612717.png)

  - 继续配置路由，`ip`配置好了，需要让本机能够访问测试机器，那么需要配置路由，让网络能够跳转过来。查看自己本机的`ip`，在本机使用命令`ipconfig`（查看`ip`因为本机一般就是公司电脑，是windows平台，所以用这个命令查看`ip`)，得到`ip`为`10.32.40.14`，那么我们配置路由的命令是

    ```
    route add -net 10.32.0.0/16 gw 10.130.48.1
    ```

    ![image-20230305161710835](linux%E9%85%8D%E7%BD%AE%E7%BD%91%E7%BB%9C%E8%AF%A6%E8%A7%A3.assets/image-20230305161710835.png)

    其中`10.32.0.0/16`表示从`10.32.0.0- 10.32.255.255`过来的访问请求都可以通过`10.130.48.1`这个

    网关进行访问测试机器。可以使用`route -n`命令查看这个路由是否配置成功。

  ![image-20230305160617851](linux%E9%85%8D%E7%BD%AE%E7%BD%91%E7%BB%9C%E8%AF%A6%E8%A7%A3.assets/image-20230305160617851.png)

## 错误排查

- 检测`ip`是否和网关在同一个网段，使用命令`ifconfig`查看配置的`ip`

  ![image-20230305160822056](linux%E9%85%8D%E7%BD%AE%E7%BD%91%E7%BB%9C%E8%AF%A6%E8%A7%A3.assets/image-20230305160822056.png)

- 检测路由是否配置正确，即内网跳转路线是否正确，如果在公司内网，第一个红框应该是本机所在网段，在本次示例中应该为`10.32.0.0/16`或者`10.32.40.0/24`都可以

  ![image-20230305161043840](linux%E9%85%8D%E7%BD%AE%E7%BD%91%E7%BB%9C%E8%AF%A6%E8%A7%A3.assets/image-20230305161043840.png)

- 查看你配置`ip`的网口是否是你插网线的网口。这个使用`ethtool -p ethx`进行排除

  